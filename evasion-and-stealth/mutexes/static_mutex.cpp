// Author: Nemuel Wainaina

#include <iostream>
#include <windows.h>

int payload() {
    MessageBoxW(NULL, L"Payload executed", L"Alert", MB_OK);
}

int main() {
    HANDLE hMutex = CreateMutexW(NULL, FALSE, L"WindowsMalwareTechniques_StaticMutex");

    if(hMutex && GetLastError() == ERROR_ALREADY_EXISTS) {
        std::cout << "Another instance is already running. Quitting ..." <<  std::endl;
        CloseHandle(hMutex);
        return 0;
    }

    payload();
    CloseHandle(hMutex);
    return 0;
}
